(()=>{var e={};e.id=331,e.ids=[331],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},8359:()=>{},3739:()=>{},2295:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),r(574),r(3321),r(6271),r(5866);var s=r(3191),i=r(8716),a=r(7922),o=r.n(a),n=r(5231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let d=["",{children:["dashboard",{children:["chat",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,574)),"C:\\Users\\hp\\Desktop\\n\\client\\app\\dashboard\\chat\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,3321)),"C:\\Users\\hp\\Desktop\\n\\client\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,6271)),"C:\\Users\\hp\\Desktop\\n\\client\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\hp\\Desktop\\n\\client\\app\\dashboard\\chat\\page.tsx"],u="/dashboard/chat/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/chat/page",pathname:"/dashboard/chat",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5117:(e,t,r)=>{Promise.resolve().then(r.bind(r,110))},110:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v,dynamic:()=>g,revalidate:()=>f});var s=r(326),i=r(5047),a=r(7577),o=r(57),n=r(6824),l=r(2196),d=r(8144),c=r(772),u=r(4432),p=r(5515),x=r(6418),h=r(9436),m=r(9322);let g="force-dynamic",f=0;function b(e){return e?e.startsWith("http")?e:`http://localhost:8000${e.startsWith("/")?e:`/${e}`}`:""}function v(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)(null),[g,f]=(0,a.useState)([]),[v,y]=(0,a.useState)(""),[j,w]=(0,a.useState)(!1),[k,N]=(0,a.useState)(!1),[_,q]=(0,a.useState)(null),S=(0,a.useRef)(null),U=(0,a.useRef)(null);(0,i.useRouter)();let C=(0,a.useMemo)(()=>"",[]);console.log(b());let P=async()=>{if(!e?._id||!v.trim())return;let t=r||"68bd7d05bcffcf5a4f72f6c7";if(t)try{let r=await n.xU.sendMessage({to:t,message:v.trim(),type:"text"},{token:C,senderId:e._id});f(s=>[...s,{...r,sender:e._id,receiver:t,fileUrl:b(r.fileUrl)}]),y(""),w(!1)}catch(e){console.error("sendMessage error",e)}},R=async t=>{if(r){N(!0);try{let s=new FormData;s.append("file",t);let{fileUrl:i}=await n.xU.upload(s,C),a=t.type.startsWith("audio")?"audio":"image";if(!e)return;let o=await n.xU.sendMessage({to:r,fileUrl:i,type:a},{token:C,senderId:e._id});f(t=>t.some(e=>e._id===o._id)?t:[...t,{...o,sender:e._id,receiver:r,fileUrl:b(o.fileUrl)}]),q(null)}catch(e){console.error("upload/send error",e)}finally{N(!1)}}},z=async()=>{if(!_?.blob)return;let e=new File([_.blob],"voice.webm",{type:"audio/webm"});await R(e)};return s.jsx("div",{className:"h-[calc(100vh-2rem)] p-3",children:(0,s.jsxs)("div",{className:"h-full rounded-2xl border border-white/10 bg-white/5 backdrop-blur flex flex-col",children:[(0,s.jsxs)("div",{className:"p-3 border-b border-white/10",children:[s.jsx("div",{className:"font-semibold",children:"(Admin) Ready to hear from you!!!"}),s.jsx("div",{className:"text-xs opacity-70",children:e?`Signed in as ${e.name}`:"Loading…"})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 h-0",children:[g.map((t,r)=>s.jsx(l.Z,{msg:t,me:e?._id||""},`${t._id||"local"}-${t.createdAt||Date.now()}-${r}`)),s.jsx("div",{ref:S})]}),(0,s.jsxs)("div",{className:"p-3 border-t border-white/10",children:[_&&(0,s.jsxs)("div",{className:"mb-2 flex items-center gap-3 rounded-xl border border-white/10 p-2 bg-white/5",children:["image"===_.kind?s.jsx("img",{src:_.url,alt:"uploaded-file",className:"max-h-32 rounded-lg object-contain"}):s.jsx("audio",{src:_.url,controls:!0,className:"w-64"}),(0,s.jsxs)("div",{className:"ml-auto flex gap-2",children:[s.jsx(c.z,{onClick:()=>q(null),variant:"ghost",className:"border border-white/10",children:"Discard"}),"audio"===_.kind?s.jsx(c.z,{onClick:z,disabled:k,children:k?"Sending…":"Send"}):s.jsx(c.z,{onClick:async()=>{let e=await fetch(_.url),t=await e.blob(),r=t.type.split("/")[1]||"png",s=new File([t],`image.${r}`,{type:t.type});await R(s)},disabled:k,children:k?"Sending…":"Send"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(c.z,{size:"icon",variant:"ghost",onClick:()=>w(e=>!e),title:"Emoji",children:s.jsx(p.Z,{size:18})}),s.jsx(d.Z,{onStop:e=>{q({url:URL.createObjectURL(e),kind:"audio",blob:e})}}),s.jsx("input",{ref:U,type:"file",accept:"image/*,audio/*","data-testid":"chat-file-input",className:"hidden",onChange:e=>{let t=e.target.files?.[0];t&&(t.type.startsWith("audio")?q({url:URL.createObjectURL(t),kind:"audio",blob:t}):q({url:URL.createObjectURL(t),kind:"image"}),e.currentTarget.value="")}}),s.jsx(c.z,{size:"icon",variant:"ghost",onClick:()=>U.current?.click(),title:"Attach",children:s.jsx(x.Z,{size:18})}),s.jsx(u.I,{placeholder:"Type a message",value:v,onChange:e=>y(e.target.value),onKeyDown:e=>"Enter"===e.key&&P(),className:"flex-1 bg-white/10 text-white placeholder:text-white/60 border-white/20"}),(0,s.jsxs)(c.z,{onClick:P,disabled:!v.trim(),children:[s.jsx(h.Z,{size:16,className:"mr-1"}),"Send"]})]}),j&&s.jsx("div",{className:"mt-2",children:s.jsx(m.ZP,{onEmojiClick:e=>y(t=>t+e.emoji)})})]})]})})}(0,o.ZP)("http://localhost:8000",{autoConnect:!0})},2196:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(326),i=r(7577);function a({msg:e,me:t}){let[r,a]=(0,i.useState)(!1),o=e.sender===t,n=new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),l=e.fileUrl?.startsWith("http")?e.fileUrl:`http://localhost:8000${e.fileUrl}`;return console.log(l),(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:`my-2 flex ${o?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:"max-w-[75%]",children:[s.jsx("div",{className:`px-3 py-2 rounded-2xl shadow-md text-sm ${o?"bg-blue-600 text-white rounded-br-none":"bg-[#24344d] text-gray-100 rounded-bl-none"}`,children:"image"===e.type?s.jsx("img",{src:l,alt:"sent",className:"rounded-lg max-h-64 object-cover cursor-pointer",onClick:()=>a(!0)}):"audio"===e.type?s.jsx("audio",{src:l,controls:!0,className:"w-56"}):s.jsx("span",{children:e.message})}),s.jsx("div",{className:`text-[10px] mt-1 ${o?"text-right":"text-left"} text-gray-400`,children:n})]})}),r&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:()=>a(!1),children:s.jsx("img",{src:l,alt:"preview",className:"max-h-[90vh] max-w-[90vw] object-contain rounded-lg"})})]})}},8144:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(326),i=r(7577);function a({onStop:e}){let t=(0,i.useRef)(null),r=(0,i.useRef)([]),[a,o]=(0,i.useState)(!1),n=async()=>{let s=await navigator.mediaDevices.getUserMedia({audio:!0}),i=MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?"audio/webm;codecs=opus":MediaRecorder.isTypeSupported("audio/ogg;codecs=opus")?"audio/ogg;codecs=opus":"audio/webm",a=new MediaRecorder(s,{mimeType:i});t.current=a,r.current=[],a.ondataavailable=e=>{e.data.size>0&&r.current.push(e.data)},a.onstop=()=>{e(new Blob(r.current,{type:i})),s.getTracks().forEach(e=>e.stop())},a.start(),o(!0)};return s.jsx("button",{onClick:a?()=>{t.current?.stop(),o(!1)}:n,className:`px-3 py-2 rounded-full text-sm ${a?"bg-red-600":"bg-blue-600"}`,title:a?"Stop":"Record voice",children:a?"■ Stop":"● Voice"})}},772:(e,t,r)=>{"use strict";r.d(t,{z:()=>d});var s=r(326),i=r(7577),a=r(6438),o=r(9360),n=r(7863);let l=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef(({className:e,variant:t,size:r,asChild:i=!1,...o},d)=>{let c=i?a.g7:"button";return s.jsx(c,{className:(0,n.cn)(l({variant:t,size:r,className:e})),ref:d,...o})});d.displayName="Button"},4432:(e,t,r)=>{"use strict";r.d(t,{I:()=>o});var s=r(326),i=r(7577),a=r(7863);let o=i.forwardRef(({className:e,type:t,...r},i)=>s.jsx("input",{type:t,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...r}));o.displayName="Input"},7863:(e,t,r)=>{"use strict";r.d(t,{cn:()=>a});var s=r(1135),i=r(1009);function a(...e){return(0,i.m6)((0,s.W)(e))}},574:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>a,default:()=>d,dynamic:()=>n,revalidate:()=>l});var s=r(8570);let i=(0,s.createProxy)(String.raw`C:\Users\hp\Desktop\n\client\app\dashboard\chat\page.tsx`),{__esModule:a,$$typeof:o}=i;i.default;let n=(0,s.createProxy)(String.raw`C:\Users\hp\Desktop\n\client\app\dashboard\chat\page.tsx#dynamic`),l=(0,s.createProxy)(String.raw`C:\Users\hp\Desktop\n\client\app\dashboard\chat\page.tsx#revalidate`),d=(0,s.createProxy)(String.raw`C:\Users\hp\Desktop\n\client\app\dashboard\chat\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[583,404,286,951],()=>r(2295));module.exports=s})();